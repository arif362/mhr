<div class="col-sm-12 reset-padding">
  <div class="text-center">
    <h3><%= 'Expense report breakdown from ' + format_date(@start_date).to_s + ' to ' + format_date(@end_date).to_s %></h3>
    <% if @expense_category.present? %>
        <h4><%= 'Category : ' + @expense_category.name %></h4>
        <% elsif @expense_sub_category.present? %>
        <h4><%= 'Sub Category : ' + @expense_sub_category.name %></h4>
    <% end %>
  </div>
</div>
<table class="table action-table beaccount-table tablesorter table-responsive table-hover table-striped">
  <thead>
  <tr>
    <th>Category</th>
    <th>Subcategory</th>
    <th>Date</th>
    <th>Amount</th>
    <th>Created By</th>
    <th>Status</th>
    <th></th>
  </tr>
  </thead>
  <tbody>
  <% total_expense = 0 %>
  <% @expenses.each do |expense| %>
      <tr>
        <td><%= expense.expense_category.name if expense.expense_category.present? %></td>
        <td><%= expense.expense_sub_category.name if expense.expense_sub_category.present?%></td>
        <td><%= format_date(expense.date) %></td>
        <td><%= expense.amount %></td>
        <% total_expense += expense.amount %>
        <td>
          <%if expense.created_by.present? %>
              <%=link_to employee_profile_path(expense.created_by), remote:true do%>
          <%= expense.created_by.full_name%>
                  <% end %>
              <% end %>
        </td>
        <td>
          <%= expense.status.capitalize %>
        </td>
        <td>
          <% unless expense.status == AppSettings::REMARK_STATUS[:approved] %>
              <%= link_to 'Approve', approve_reject_expenses_expense_path(expense, is_approved: 'yes'),  data: {confirm: "Are you sure you want to Approve this expense?"} %>
              <%= link_to 'Remark', new_remark_path(remarkable_object: expense, remarkable_type: expense.class.name), remote: true %>
          <% end %>
          <%= link_to expenses_expense_path(expense), class: 'btn info-color', remote: true do %>
              <i class="fa fa-eye"></i>
          <% end %>
          <%= link_to edit_expenses_expense_path(expense), class: 'btn warning-color', remote: true do %>
              <i class="fa fa-pencil"></i>
          <% end %>
          <%= link_to expenses_expense_path(expense), method: :delete, class: 'btn danger-color',  data: {confirm: "Are you sure you want to delete this expense?"} do %>
              <i class="fa fa-times"> </i>
          <% end %>
        </td>
      </tr>
  <% end %>
  <tr>
    <td></td>
    <td></td>
    <td><b>Total</b></td>
    <td><b><%= total_expense %></b></td>
    <td></td>
    <td></td>
    <td></td>
  </tr>
  </tbody>
</table>