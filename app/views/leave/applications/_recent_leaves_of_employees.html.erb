<div class="header-wrapper">
  <h4>
    Recent Leaves of Employees
  </h4>
</div>
<div class="row reset-padding secondary-color">
  <div class="table-content">
    <div class="content-body row mt20">
      <div class="site-header">
        <div class="pull-right">
          <% if employee_role == 'admin' %>
              <%= select_tag :recent_export_to, options_for_select(AppSettings::EXPORT_TO.collect { |opt| [opt.camelize, opt] }), {class: 'custom-chosen form-control custom-export-to', prompt: 'Export To....'} %>
          <% end %>
        </div>
        <div class="text-center">
          <h3> Recent Leaves of Employees </h3>
        </div>
      </div>
      <div class="panel table-warapper ">
        <div class="table-warapper-body">
          <table class="table action-table beaccount-table tablesorter table-responsive table-hover table-striped">
            <thead>
            <tr class="trew">
              <th>Name</th>
              <th>Leave Category</th>
              <th>Type</th>
              <th>Taken Days</th>
              <th>Days</th>
              <th></th>
            </tr>
            </thead>
            <tbody>
            <% @recent_leave_days.each do |leave_day| %>
                <tr>
                  <td>
                    <% if leave_day.leave_application.employee.present? %>
                        <%= link_to employee_path(leave_day.leave_application.employee) do %>
                            <%= leave_day.leave_application.employee.full_name %>
                        <% end %>
                    <% end %>
                  </td>
                  <td><%= leave_day.leave_application.leave_category.name %></td>
                  <td><%= leave_day.leave_application.is_paid ? 'Paid' : 'Unpaid' %></td>
                  <td><%= leave_day.leave_application.total_days %></td>
                  <% days = '' %>
                  <% leave_day.leave_application.leave_days.each do |application_leave_day| %>
                      <% if application_leave_day.is_approved %>
                          <% days = days.present? ? days + ', ' + application_leave_day.day.to_s : application_leave_day.day.to_s %>
                      <% end %>
                  <% end %>
                  <td><%= days %></td>
                  <td>
                    <%= link_to leave_application_path(leave_day.leave_application, no_admin: true), remote: true do %>
                        <i class="fa fa-eye"> </i>
                    <% end %>
                  </td>
                </tr>
            <% end %>
            </tbody>
          </table>
          <%= render 'shared/pagination' if @recent_leave_days.size > 10 %>
        </div>
      </div>
    </div>
  </div>
</div>